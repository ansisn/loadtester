# HTTP负载测试工具 - 多代理多线程版

一个功能强大的HTTP负载测试工具，支持多代理和多线程，用于测试Web服务的性能和稳定性。

## 功能特性

- 支持多代理轮换，防止IP被封
- 支持多线程并发，提高测试效率
- 支持异步和同步两种模式
- 详细的性能统计分析
- 响应时间分析（平均值、中位数、最大最小值）
- 状态码分布统计
- 代理使用统计和成功率分析
- QPS计算
- 结果导出为JSON格式

## 安装依赖

```bash
pip install -r requirements.txt
```

或者手动安装：

```bash
pip install aiohttp requests
```

## 使用方法

### 基本用法

```bash
python load_tester.py http://example.com
```

### 多代理多线程用法

```bash
# 使用代理文件进行测试
python load_tester.py http://example.com -p proxies.txt -c 50 -n 1000 -t 4

# 直接指定代理列表
python load_tester.py http://example.com --proxy-list 192.168.1.1:8080 192.168.1.2:8080 -c 20 -t 2

# 使用异步模式（更高性能）
python load_tester.py http://example.com -p proxies.txt --async-mode -c 100 -n 2000 -t 8

# 保存结果到文件
python load_tester.py http://example.com -p proxies.txt -c 50 -n 1000 -t 4 -o results.json
```

### 参数说明

- `url`: 目标URL（必需）
- `-c, --concurrent`: 并发数，默认10
- `-n, --requests`: 总请求数，默认100
- `-t, --threads`: 线程数，默认1
- `-p, --proxy-file`: 代理列表文件路径
- `--proxy-list`: 直接指定代理列表
- `--async-mode`: 使用异步模式（默认同步多线程）
- `-o, --output`: 结果输出到JSON文件

### 代理文件格式

创建一个文本文件（如 `proxies.txt`），每行一个代理地址：

```
192.168.1.1:8080
192.168.1.2:8080
proxy.example.com:3128
```

## 输出示例

### 多代理多线程测试输出

```
开始负载测试...
目标URL: http://example.com
并发数: 50
线程数: 4
总请求数: 1000
代理数量: 75
--------------------------------------------------

==================================================
负载测试结果
==================================================
总请求数: 1000
成功请求数: 987
失败请求数: 13
成功率: 98.70%
总耗时: 12.45秒
QPS: 80.32
状态码分布:
  200: 987次
  0: 13次
代理使用统计:
  172.96.91.216:3128: 成功15次, 失败1次 (成功率: 93.8%)
  158.62.209.219:3128: 成功12次, 失败0次 (成功率: 100.0%)
  158.62.210.87:3128: 成功14次, 失败2次 (成功率: 87.5%)
  ... (显示所有使用的代理统计)
平均响应时间: 245.67ms
最小响应时间: 123.45ms
最大响应时间: 567.89ms
响应时间中位数: 234.56ms
响应时间标准差: 89.12ms
==================================================
```

## 注意事项

1. 请确保你有权限对目标服务器进行负载测试
2. 建议从小的并发数开始测试，逐步增加
3. 注意监控目标服务器的资源使用情况
4. 本工具仅用于合法的性能测试目的

## 扩展功能

你可以根据需要扩展以下功能：
- 支持POST请求和自定义请求头
- 添加认证支持
- 支持代理设置
- 添加更多统计指标
- 实时进度显示
